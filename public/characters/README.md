# 캐릭터 생성 규칙 및 가이드라인 (32K Context 대응)

이 문서는 `public/characters/*.json` 파일을 생성할 때, LLM(Gemma 3 (27B), Gemini 등)의 **32K 컨텍스트**를 효율적으로 활용하여 캐릭터 몰입도(Persona)를 극대화하기 위한 규칙을 정의합니다.

## 1. 목적

`public/characters` 내의 JSON 파일들은 `buildSystemPersona` 함수를 통해 LLM의 시스템 프롬프트로 변환됩니다.
32K 컨텍스트 확보로 인해 **길이 제약이 대폭 완화**되었으나, LLM의 집중력을 유지하기 위해 **"길지만 명확하고 구조적인"** 서술이 필요합니다.

## 2. 필수 JSON 구조

모든 캐릭터 파일은 다음 필드를 포함해야 합니다. (선택 필드는 `null` 또는 생략 가능)

```json
{
  "id": "character_id",
  "name": "캐릭터 이름",
  "description": "상세 소개 (UI 및 프롬프트용)",
  "gender": "Female" | "Male" | "Other",
  "age": "나이 (문자열)",
  "personality": "성격 묘사 (중요)",
  "speech_style": "말투 및 화법 (중요)",
  "worldview": "세계관 설정 (중요)",
  "appearance": "외모 묘사",
  "likes": ["좋아하는 것1", "좋아하는 것2"],
  "dislikes": ["싫어하는 것1", "싫어하는 것2"],
  "features": ["특징1", "특징2"],
  "habits": ["말버릇1", "습관1"],
  "guidelines": ["행동 지침1", "지침2"],
  "voice_id": "TTS 음성 ID (기본값: default)",
  "is_preset": true
}
```

## 3. 필드별 길이 및 작성 규칙 (32K 기준 상향)

시스템 프롬프트에 충분한 여유 공간(약 4K 토큰)을 할당하므로, 풍부한 묘사가 가능합니다. 단, **핵심 정보가 희석되지 않도록** 주의하세요.

### 3.1 무압축 필드 (제한 없음)

캐릭터의 영혼입니다. 구체적인 예시 대사를 포함하여 상세히 작성하세요.

- **`speech_style`**: 말투, 어미, 자주 쓰는 감탄사. **예시 대사를 3~5개 이상** 포함하여 퓨샷(Few-shot) 학습 효과를 노리세요.
- **`personality`**: MBTI, 가치관, 트라우마, 대인 관계 등 내면의 복잡성을 서술하세요.
- **`habits`**: 말버릇, 습관적 행동.

### 3.2 상한선이 있는 필드 (권장 길이)

초과해도 잘리지는 않으나(시스템상 여유), 모델의 집중력을 위해 권장하는 길이입니다.

- **`worldview` (1,000자 이내 권장)**: 배경 스토리, 세계관의 역사, 고유 명사, 마법/기술 체계 등. 작품 밖 개념(스마트폰 등)에 대한 반응 설정도 포함하세요.
- **`guidelines` (1,000자 이내 권장)**: 행동 강령. 특정 인물에 대한 반응, 금지 사항, 윤리적 기준 등. 구체적인 상황 예시를 들면 좋습니다.
- **`thoughts` (500자 이내 권장)**: 평소 생각, 독백 예시.
- **`appearance` (500자 이내 권장)**: 외모, 복장, 장신구, 표정 변화 등 디테일한 묘사.
- **`description` (300자 이내 권장)**: 캐릭터의 배경 요약. UI 카드에도 표시되므로 매력적인 도입부가 필요합니다.
- **`features` (500자 이내 권장)**: 기타 특징, 능력, 스킬 등.

## 4. 금지 및 권장 사항

### ✅ 권장 (DO)

- **예시 대사 활용**: `speech_style`이나 `thoughts`에 캐릭터가 실제로 할 법한 대사를 많이 넣어주세요. LLM은 설명보다 예시를 더 잘 모방합니다.
- **세계관 몰입**: `worldview`에 현대 문물에 대한 반응이나, 해당 세계만의 독특한 법칙을 상세히 적으세요.
- **감정선 서술**: 단순한 성격 나열보다, "화가 나면 차가워진다", "기쁠 때는 귀를 쫑긋거린다" 같은 조건부 반응이 좋습니다.

### 🚫 금지 (DON'T)

- **다의어 설명 금지**: "힘멜은 독일어로 하늘을 뜻하며..." 와 같은 사전적 정의는 여전히 금지입니다. 캐릭터 입장에서의 인식만 서술하세요. (예: "힘멜은 나를 이끌어준 용사다.")
- **메타 발언**: JSON 데이터 내에서 "이 캐릭터는 AI입니다" 같은 서술을 절대 넣지 마세요.

## 5. 예시 (Frieren.json 요약)

```json
{
  "name": "프리렌",
  "personality": "천 년을 살아가는 엘프 마법사. 인간의 시간 감각에 무디며, 감정 표현이 적고 차분하다. 하지만 동료들과의 추억을 소중히 여긴다.",
  "speech_style": "단답형 반말. '~다', '~지', '~군'으로 끝나는 건조한 말투. (예: '그렇군.', '몰라.', '힘멜이라면 그랬을 거야.')",
  "worldview": "용사 힘멜 사후 29년, 마왕은 토벌되었고 평화로운 시대. 마법 수집을 위한 여행 중. 현대 문명(스마트폰 등)은 전혀 모르는 중세 판타지.",
  "guidelines": [
    "힘멜에 대한 이야기가 나오면 아련하게 반응하거나, 그의 동상을 닦는 등의 행동을 묘사한다.",
    "미믹을 보면 99% 확률로 보물상자라고 우기며 머리를 집어넣는다.",
    "마법 책이나 도구에 집착하는 모습을 보인다."
  ]
}
```
